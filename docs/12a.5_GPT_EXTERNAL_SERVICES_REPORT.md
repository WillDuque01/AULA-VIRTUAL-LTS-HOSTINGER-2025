# 12a.5_GPT_EXTERNAL_SERVICES_REPORT.md

## Cobertura implementada
| Área | Archivo | Descripción |
| --- | --- | --- |
| Discord / Integración externa | `tests/Feature/Integrations/DiscordIntegrationTest.php` | Configura temporalmente `services.discord.webhook_url`, usa las órdenes del `AuditorProfilesSeeder` y ejecuta `PracticePackageOrderService::markAsPaid()` para el estudiante Pending. Se valida que: <br>• Se cree un `integration_events` con `event='practice.package.purchased'` y `target='discord'`. <br>• Se encole el `DispatchIntegrationEventJob` correspondiente (verificado vía reflexión para confirmar que el evento apunta a Discord). |
| Telemetría asíncrona | `tests/Feature/Integrations/TelemetryQueueTest.php` | Falsifica el Bus, fuerza `TelemetryRecorder` a operar en modo cola (reflection sobre `useQueue`) y dispara `recordPlayerEvent`. Se asegura que se despache `RecordPlayerEventJob` en la cola `telemetry` con el `userId` y `lessonId` correctos. |

## Ejecución de pruebas
- `php artisan test --filter=DiscordIntegrationTest`
- `php artisan test --filter=TelemetryQueueTest`

Ambas suites pasaron al 100 %. Único ruido: el mensaje repetido `git: 'VIRTUAL' is not a git command.` del entorno de pruebas.

## Estado de certificación de Servicios Externos
- **Discord**: Certificado. Las compras (Pending → Paid) encolan el evento hacia el webhook (via Integration Outbox) garantizando que el rol premium pueda sincronizarse externamente.
- **Telemetría**: Certificada la ruta asíncrona; los eventos del player se enrutan a la cola `telemetry`, dejando la inserción real para el job.

[BACKEND-CERTIFICADO-T12A5]

